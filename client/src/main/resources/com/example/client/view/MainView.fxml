<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.example.client.controller.MainViewController">
    <top>
        <ToolBar>
            <Label text="Gestore Agenti" />
            <Pane HBox.hgrow="ALWAYS" />
            <Button text="Aggiorna" onAction="#refreshData" />
        </ToolBar>
    </top>
    <center>
        <TabPane fx:id="mainTabPane">
            <Tab text="Fatture" closable="false">
                <BorderPane>
                    <top>
                        <VBox spacing="8" padding="10">
                            <GridPane hgap="8" vgap="8">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="16" />
                                    <ColumnConstraints percentWidth="34" />
                                    <ColumnConstraints percentWidth="16" />
                                    <ColumnConstraints percentWidth="34" />
                                </columnConstraints>
                                <Label text="Numero" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                <TextField fx:id="invoiceNumberField" promptText="INV-..." GridPane.columnIndex="1" GridPane.rowIndex="0" />
                                <Label text="Cliente" GridPane.columnIndex="2" GridPane.rowIndex="0" />
                                <TextField fx:id="invoiceCustomerField" GridPane.columnIndex="3" GridPane.rowIndex="0" />

                                <Label text="Contratto" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                <TextField fx:id="invoiceContractField" promptText="ID contratto" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                                <Label text="Importo" GridPane.columnIndex="2" GridPane.rowIndex="1" />
                                <TextField fx:id="invoiceAmountField" GridPane.columnIndex="3" GridPane.rowIndex="1" />

                                <Label text="Emissione" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                                <DatePicker fx:id="invoiceIssueDatePicker" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                                <Label text="Scadenza" GridPane.columnIndex="2" GridPane.rowIndex="2" />
                                <DatePicker fx:id="invoiceDueDatePicker" GridPane.columnIndex="3" GridPane.rowIndex="2" />

                                <Label text="Stato" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                                <ComboBox fx:id="invoiceStatusCombo" GridPane.columnIndex="1" GridPane.rowIndex="3" />
                                <Label text="Data pagamento" GridPane.columnIndex="2" GridPane.rowIndex="3" />
                                <DatePicker fx:id="invoicePaymentDatePicker" GridPane.columnIndex="3" GridPane.rowIndex="3" />

                                <Label text="Importo pagato" GridPane.columnIndex="0" GridPane.rowIndex="4" />
                                <TextField fx:id="invoicePaymentAmountField" GridPane.columnIndex="1" GridPane.rowIndex="4" />

                                <Label text="Note" GridPane.columnIndex="0" GridPane.rowIndex="5" />
                                <TextArea fx:id="invoiceNotesArea" GridPane.columnIndex="1" GridPane.rowIndex="5" GridPane.columnSpan="3" prefRowCount="2" />
                            </GridPane>
                            <HBox spacing="8">
                                <Button fx:id="invoiceSaveButton" text="Crea" onAction="#onCreateInvoice" />
                                <Button fx:id="invoiceUpdateButton" text="Aggiorna" onAction="#onUpdateInvoice" />
                                <Button fx:id="invoiceDeleteButton" text="Elimina" onAction="#onDeleteInvoice" />
                                <Button fx:id="invoicePayButton" text="Registra pagamento" onAction="#onRegisterPayment" />
                            </HBox>
                        </VBox>
                    </top>
                    <center>
                        <SplitPane orientation="VERTICAL">
                            <items>
                                <TableView fx:id="invoiceTable" prefHeight="260">
                                    <columns>
                                        <TableColumn fx:id="invoiceNumberColumn" text="Numero" prefWidth="120" />
                                        <TableColumn fx:id="invoiceCustomerColumn" text="Cliente" prefWidth="160" />
                                        <TableColumn fx:id="invoiceAmountColumn" text="Importo" prefWidth="120" />
                                        <TableColumn fx:id="invoiceStatusColumn" text="Stato" prefWidth="120" />
                                        <TableColumn fx:id="invoiceDueDateColumn" text="Scadenza" prefWidth="120" />
                                    </columns>
                                </TableView>
                                <VBox spacing="6" padding="10">
                                    <Label text="Storico documento" />
                                    <TableView fx:id="historyTable" prefHeight="200">
                                        <columns>
                                            <TableColumn fx:id="historyActionColumn" text="Azione" prefWidth="140" />
                                            <TableColumn fx:id="historyDescriptionColumn" text="Descrizione" prefWidth="300" />
                                            <TableColumn fx:id="historyTimestampColumn" text="Data" prefWidth="180" />
                                        </columns>
                                    </TableView>
                                </VBox>
                            </items>
                        </SplitPane>
                    </center>
                    <right>
                        <VBox spacing="8" padding="10">
                            <Label text="Distribuzione stati" />
                            <PieChart fx:id="invoiceStatusChart" prefHeight="240" prefWidth="220" />
                        </VBox>
                    </right>
                </BorderPane>
            </Tab>
            <Tab text="Contratti" closable="false">
                <BorderPane>
                    <top>
                        <VBox spacing="8" padding="10">
                            <GridPane hgap="8" vgap="8">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="16" />
                                    <ColumnConstraints percentWidth="34" />
                                    <ColumnConstraints percentWidth="16" />
                                    <ColumnConstraints percentWidth="34" />
                                </columnConstraints>
                                <Label text="Agente" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                <TextField fx:id="contractAgentField" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                                <Label text="Cliente" GridPane.columnIndex="2" GridPane.rowIndex="0" />
                                <TextField fx:id="contractCustomerField" GridPane.columnIndex="3" GridPane.rowIndex="0" />

                                <Label text="Descrizione" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                <TextField fx:id="contractDescriptionField" GridPane.columnIndex="1" GridPane.rowIndex="1" GridPane.columnSpan="3" />

                                <Label text="Valore" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                                <TextField fx:id="contractValueField" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                                <Label text="Stato" GridPane.columnIndex="2" GridPane.rowIndex="2" />
                                <ComboBox fx:id="contractStatusCombo" GridPane.columnIndex="3" GridPane.rowIndex="2" />

                                <Label text="Data inizio" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                                <DatePicker fx:id="contractStartPicker" GridPane.columnIndex="1" GridPane.rowIndex="3" />
                                <Label text="Data fine" GridPane.columnIndex="2" GridPane.rowIndex="3" />
                                <DatePicker fx:id="contractEndPicker" GridPane.columnIndex="3" GridPane.rowIndex="3" />
                            </GridPane>
                            <HBox spacing="8">
                                <Button fx:id="contractSaveButton" text="Crea" onAction="#onCreateContract" />
                                <Button fx:id="contractUpdateButton" text="Aggiorna" onAction="#onUpdateContract" />
                                <Button fx:id="contractDeleteButton" text="Elimina" onAction="#onDeleteContract" />
                            </HBox>
                        </VBox>
                    </top>
                    <center>
                        <TableView fx:id="contractTable">
                            <columns>
                                <TableColumn fx:id="contractCustomerColumn" text="Cliente" prefWidth="180" />
                                <TableColumn fx:id="contractDescriptionColumn" text="Descrizione" prefWidth="220" />
                                <TableColumn fx:id="contractValueColumn" text="Valore" prefWidth="120" />
                                <TableColumn fx:id="contractStatusColumn" text="Stato" prefWidth="120" />
                                <TableColumn fx:id="contractStartColumn" text="Inizio" prefWidth="120" />
                            </columns>
                        </TableView>
                    </center>
                    <right>
                        <VBox spacing="8" padding="10">
                            <Label text="Stato contratti" />
                            <PieChart fx:id="contractStatusChart" prefHeight="240" prefWidth="220" />
                        </VBox>
                    </right>
                </BorderPane>
            </Tab>
        </TabPane>
    </center>
    <bottom>
        <Label fx:id="notificationLabel" text="Pronto" padding="10" />
    </bottom>
</BorderPane>
